{% extends "base.html" %}
{% block content %}
    <h2>ğŸ’¼ å§”è¨—äººå„€è¡¨æ¿</h2>
    <p>æ‚¨å¥½ï¼Œ{{ current_user.username }}ã€‚åœ¨é€™è£¡æ‚¨å¯ä»¥ç®¡ç†æ‚¨çš„å°ˆæ¡ˆå§”è¨—ã€‚</p>

    <h3>âœ¨ å°ˆæ¡ˆæ“ä½œ</h3>
    <a href="{{ url_for('create_project') }}" class="btn btn-success">+ å»ºç«‹/ç™¼å¸ƒæ–°å°ˆæ¡ˆ</a>
    
    <hr>
    
    <h3>ğŸ“ æˆ‘çš„å°ˆæ¡ˆåˆ—è¡¨ (é€²è¡Œä¸­æˆ–å…¬é–‹ä¸­, å…± {{ projects | length }} å€‹)</h3>
    {% if projects %}
        <table>
            <tr>
                <th>å°ˆæ¡ˆæ¨™é¡Œ</th>
                <th>ç‹€æ…‹</th>
                <th>ç™¼å¸ƒæ™‚é–“</th>
                <th>æ¥æ¡ˆäºº</th>
                <th>æ“ä½œ</th>
            </tr>
            {% for project in projects %}
            <tr>
                <td><a href="{{ url_for('project_detail', project_id=project.id) }}">{{ project.title }}</a></td>
                <td><span class="status-{{ project.status }}">{{ project.status }}</span></td>
                <td>{{ project.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ project.contractor.username | ternary(project.contractor.username, 'å¾…å®š') }}</td>
                <td>
                    <a href="{{ url_for('project_detail', project_id=project.id) }}" class="btn btn-info">æŸ¥çœ‹è©³æƒ…/å ±åƒ¹</a>
                    {% if project.status == 'open' %}
                        <a href="{{ url_for('edit_project', project_id=project.id) }}" class="btn btn-warning">ç·¨è¼¯å°ˆæ¡ˆ</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>æ‚¨å°šæœªç™¼å¸ƒä»»ä½•é€²è¡Œä¸­æˆ–å…¬é–‹ä¸­çš„å°ˆæ¡ˆã€‚</p>
    {% endif %}

    <hr>
    
    <h3>ğŸ“œ æ­·å²å°ˆæ¡ˆ (å·²çµæ¡ˆ/å·²æ‹’çµ•, å…± {{ historical_projects | length }} å€‹)</h3>
    {% if historical_projects %}
        <table>
            <tr>
                <th>å°ˆæ¡ˆæ¨™é¡Œ</th>
                <th>ç‹€æ…‹</th>
                <th>ç™¼å¸ƒæ™‚é–“</th>
                <th>æ¥æ¡ˆäºº</th>
                <th>æ“ä½œ</th>
            </tr>
            {% for project in historical_projects %}
            <tr>
                <td><a href="{{ url_for('project_detail', project_id=project.id) }}">{{ project.title }}</a></td>
                <td><span class="status-{{ project.status }}">{{ project.status }}</span></td>
                <td>{{ project.created_at.strftime('%Y-%m-%d') }}</td>
                <td>{{ project.contractor.username | ternary(project.contractor.username, 'ç„¡') }}</td>
                <td>
                    <a href="{{ url_for('project_detail', project_id=project.id) }}" class="btn btn-info">æŸ¥çœ‹è©³æƒ…</a>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>æ²’æœ‰æ­·å²å°ˆæ¡ˆè¨˜éŒ„ã€‚</p>
    {% endif %}
{% endblock %}